---
title: "Assignment05"
format: html
Author: "Yosup Shin"
embed-resources: true
---

## Data

```{r}
library(tidyverse)
library(readxl)
library(sf)
library(lubridate)
library(dplyr)
library(tidycensus)
```

```{r}
# 1. Data Loading & Cleanin
crimes <- read_csv(
  "data/Crimes_-_2001_to_Present_20251020.csv",
col_types = cols(
  Longitude = col_character(),
  Latitude = col_character()
))

names(crimes) <- names(crimes) |>
  str_replace_all("\\s","_") |>
  str_to_lower()

```

```{r}
# 2. Filtering the data to homicides within ten years of today
crimes_lim <- crimes |>
  mutate(date = mdy_hms(date)) |>
  filter(date >= today(tz="") - years(10),
         !is.na(latitude),
         !is.na(longitude),
         primary_type == "HOMICIDE")
```

```{r}
# 3. Convert Lon/Lat to Points Geometry
crimes_lim <- crimes_lim |>
  st_as_sf(coords = c("latitude", "longitude"),
           crs = 4326,
           remove = FALSE)

crimes_lim |>
  ggplot(aes(color = arrest)) +
  geom_sf() +
  scale_colour_manual(
    values = c(
      "FALSE" = "pink",
      "TRUE" = "lightblue"
    )) 

```
